<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>CodePen - bar-code-detection-2</title>
</head>

<body translate="no">
  <video id="stream" style="width: 100vw; height: 100vh;"/>
  
<script>
(async () => {
    const stream = await navigator.mediaDevices.getUserMedia({
        video: {
            facingMode: {
                ideal: "environment"
            }
        },
        audio: false
     });

    const videoEl = document.querySelector("#stream");
    videoEl.srcObject = stream;
    await videoEl.play();

    const barcodeDetector = new BarcodeDetector({ formats: ["code_39", "codabar", "ean_13"] });
    window.setInterval(async () => {
        const barcodes = await barcodeDetector.detect(videoEl);
        if (barcodes.length <= 0) return;
        alert(barcodes.map(barcode => barcode.rawValue));
    }, 1000);
})();
</script>
</body>
</html>
